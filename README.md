# sa-jpeg
Simulated annealing algorithm for reconstructing images compressed using lossy JPEG compression

This code is developed as a part of my Bachelor's Thesis work about simulated annealing (University of Helsinki, 2017). The idea is to use simulated annealing to reconstruct an image f that has been compressed using lossy JPEG compression: compressed images typically contain artefacts that lower the image quality. The reconstruction is created by combining blocks from non-compressed model images that are similar to the original image f. In simulated annealing, the search for the optimal solution (image f) progresses iteratively and stochastically by generating candidate images: a candidate is generated by replacing a random block in the current image with a random block from a random model image. The transition to the candidate image is accepted according to the defined acceptance probability. As the temperature decreases in the annealing process, the algorithm moves closer to the optimal solution and finally freezes near to it. The final state of the algorithm is the acquired reconstruction.

Simulated annealing was originally introduced by Kirkpatrick et al. [1]. The details of the implemented algorithm and its results are described and discussed in my thesis (possibly linked here later). The code should be adequately commented in English and thus followable. The thesis and the algorithm output are written in Finnish.

The source code of the MATLAB implementation is divided into folders according to the used image data set. Three sets are studied: synthetic three-colour images (folder 'synth'), images from the MNIST database of handwritten digits (folder 'mnist'), and digital photographs of matches. For the match images, two versions of the algorithm are implemented: one that follows the basic simulated annealing mechanism (folder 'match') and one that additionally deploys total variation (TV) regularisation ('match-notv') to reduce noise. The MNIST data can be downloaded from http://yann.lecun.com/exdb/mnist (download and extract file train-images-idx3-ubyte.gz). The synthetic and match images were created by me and are included in this repository in their designated folders (the match data is included only in the folder 'match-tv'). The resulting .mat files generated by the algorithm are not included due to their size. The algorithm pops up a window showing its progress during the execution, and each folder contains a png image showing the final state of the algorithm. The main executable program in each folder is sa.m. Executing each of them takes approximately 24 hours on an old laptop.

References:
[1] Scott Kirkpatrick, C. Daniel Jr. Gelatt, ja Mario P. Vecchi. Optimization by Simulated Annealing. IBM Research Report RC 9355, 1982.